# CVE-POC

# {Discoverer}
Che-Hao Chang, Jieh-Chian Wu  
National Kaohsiung University of Science and Technology

# {Description}
Attackers can (1)obtain the IMSI of 5G user equipment by setting up a rogue LTE base station. They can also (2)launch DoS and (3)service downgrade attack.

# {Product}
ASUS ZenFone 7

# {POC}
## 1. Set up micro base station 
Set up SDR:  
(1) Computer with Ubuntu 20.04 LTS 64-bit  
(2) srsRAN https://github.com/srsran/srsRAN_4G  
(3) USRP B210  
  
Collecting legitimate base station information:  
Can use app "LTE Discovery" to collect https://ltediscovery.dev/home  
Record (1)MCC (2)MNC (3)EARFCN  
![Screenshot_20230605_204013_LTE_Discovery](https://github.com/CCH1108/CVE-POC/assets/135602348/f56a5eac-8bc9-462a-a1b0-47fae2f2aa7c)  

  
Edit srsRAN:  
(1) Open "enb.conf", changing "MCC"、"MNC"、"dl_earfcn" to the collected value.  
![image](https://github.com/CCH1108/CVE-POC/assets/135602348/d2aecf1c-9c83-4887-bf85-d6001f22e9ee)  
![image](https://github.com/CCH1108/CVE-POC/assets/135602348/b2814334-af77-44f3-91a4-cd320f8002ba)  

(2) Open "sib.conf", changing "cell_resel_prio" to 7.  
![image](https://github.com/CCH1108/CVE-POC/assets/135602348/d0d4ff2e-1e21-46c6-bb4e-31cf8a3b358e)  

(3) Open "epc.conf", changing "MCC"、"MNC" to the collected value.  
![image](https://github.com/CCH1108/CVE-POC/assets/135602348/2288455a-b632-4fd7-bc59-ad32ab8b3ca0)  


## 2. Vulnerabilities  
**IMSI Disclosure**  
Start the micro base station, UE will attach to it.  
Once UE attach micro base station, the IMSI of UE will be able to capture.  
![enb](https://github.com/CCH1108/CVE-POC/assets/135602348/0da4d762-c597-405a-9b49-3b7aff18aaca)  

**Service Downgrade**  
After the UE initiates 5 Attach Requests to the micro base station, it will be downgraded to a 3G network.  
![image](https://github.com/CCH1108/CVE-POC/assets/135602348/6941da6a-1d7d-4aa8-a525-b9a40cd0146a)  

**DoS**
(1) Open "user_db.csv", adding the collected IMSI and forging a data entry.  
![image](https://github.com/CCH1108/CVE-POC/assets/135602348/17f5847d-20e9-4258-b25b-ecb31c278e23)  
(2) Restart micro base station, UE will lose service after attach micro base station.  
![DoS](https://github.com/CCH1108/CVE-POC/assets/135602348/48c7aaeb-578a-4301-9cd9-ef6b73b96607)

